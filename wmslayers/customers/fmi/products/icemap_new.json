{
    "title": "Ice map",
    "abstract": "Ice map polygons",
    "projection": {},
    "defs":
    {
    },
    "views": 
    [
        {
	    "attributes":
	    {
		"id": "view1"
	    },
            "layers": 
	    [
		{ // jääalueet
		    "qid": "icemap_areas",
		    "layer_type": "postgis",
		    "layer_subtype": "icemap",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "seaice",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
             	    "css": "shapes/ice.css",
		    "filters" :		    
		    [			
			{
			    "where": "type=1",
			    "attributes":
			    {
				"class": "OpenWater"
			    }
			},
			{
			    "where": "type=2",
			    "attributes":
			    {
				"class": "VeryOpenIce"
			    }
			},
			{
			    "where": "type=3",
			    "attributes":
			    {
				"class": "OpenIce"
			    }
			},
			{
			    "where": "type=4",
			    "attributes":
			    {
				"class": "CloseIce"
			    }
			},
			{
			    "where": "type=9",
			    "attributes":
			    {
				"class": "NewIce"
			    }
			},
			{
			    "where": "type=5",
			    "attributes":
			    {
				"class": "VeryCloseIce"
			    }
			},
			{
			    "where": "type=7",
			    "attributes":
			    {
				"class": "LevelIce"
			    }
			},
			{
			    "where": "type=6",
			    "attributes":
			    {
				"class": "ConsolidatedIce"
			    }
			},
			{
			    "where": "type=10",
			    "attributes":
			    {
				"class": "RottenFastIce"
			    }
			},
			{
			    "where": "type=8",
			    "attributes":
			    {
				"class": "FastIce"
			    }
			},
			{
			    "where": "type=0",
			    "attributes":
			    {
				"class": "IceFree"
			    }
			}
		    ]
		},
		{ // jään reuna
		    "qid": "ice_edge",
		    "layer_type": "postgis",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "icelne",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "IceEdge"
			    }
			}
		    ]
		},
		{ // arvioitu jään reuna
		    "qid": "ice_edge",
		    "layer_type": "postgis",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "estimatediceedgesymbol",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "EstimatedIceEdge"
			    }
			}
		    ]
		},
		{ // lämpötilakäyrät
		    "qid": "temperature_isotherm",
		    "layer_type": "postgis",
		    "layer_subtype": "temperature_isotherm",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "sst",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "TemperatureIsoline"
			    }
			}
		    ]
		},
		{ // maa-aluemaski
		    "qid": "icemap_landmask",
		    "layer_type": "postgis",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap_static",
		    "table" : "landmask",
		    "geometry_column" : "geom",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "IceMapLandMask"
			    }
			}
		    ]
		},
		{ // koordinaattiruudukko
		    "qid": "coordinate_grid",
		    "layer_type": "postgis",
		    "layer_subtype": "coordinate_grid",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap_static",
		    "table" : "landmask",
		    "filters" :		    
		    [			
			{
			    "where": "gid2=2",
			    "attributes":
			    {
				"class": "CoordinateLine"
			    },
			    "text_attributes":
			    {
				"font-family": "Arial",
				"font-size": "16",
				"font-style": "normal",
				"font-weight": "normal"
			    }
			}
		    ]


		},
		{ // lämpötilakäyrien labelit
		    "qid": "temperature_isotherm_labels",
		    "layer_type": "postgis",
		    "layer_subtype": "temperature_isotherm_label",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "sstannotations",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
		    "attribute_columns" : "textstring,fontname,fontsize",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{			    
			    "attributes":
			    {
				"class": "TemperatureIsolineLabel"
			    },
			    "text_attributes":
			    {
				"font-family": "Arial",
				"font-size": "18",
				"font-style": "normal",
				"font-weight": "normal",
				"text-anchor": "start"
			    }

			}
		    ]
		},
/*
		{
		    "qid": "borders",
		    "layer_type": "postgis",
		    "layer_subtype": "border",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap_static",
		    "table" : "country_borders",
		    "geometry_column" : "geom",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "TopBorder"
			    }
			}
		    ]
		},
*/
/*
		{
		    "qid": "level_ice_hatch",
		    "layer_type": "postgis",
		    "layer_subtype": "icemap",
		    "pattern": "level_ice_hatch",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "seaice",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",	
             	    "css": "shapes/ice.css",
		    "filters" :		    
		    [			
			{
			    "where": "type = 7",
			    "attributes":
			    {
				"fill": "url(#level_ice_hatch)"
			    }
			}
		    ]
		},
*/
		{ // päällekkäin ajautunut jää
		    "qid": "rafted_ice",
		    "layer_type": "postgis",
		    "layer_subtype": "symbol",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "icerft",
		    "symbol": "icerft",
//		    "symbol": "rafted_ice",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			}
		    ]
		},
		{ // ahtojää- tai röykkiölautta
		    "qid": "flbrg",
		    "layer_type": "postgis",
		    "layer_subtype": "symbol",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "flobrg",
		    "symbol": "flobrg",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			}
		    ]
		},
		{ // ahtautunut tai röykkiöitynyt jää
		    "qid": "icerdg",
		    "layer_type": "postgis",
		    "layer_subtype": "symbol",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "icerdg",
		    "symbol": "icerdg",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			}
		    ]
		},
		{ // sohjovyö
		    "qid": "jmdbrr",
		    "layer_type": "postgis",
		    "layer_subtype": "symbol",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "jmdbpt",
		    "symbol": "jmdbrr",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			}
		    ]
		},
		{ // repeämävyöhyke
		    "qid": "farcture_zone",
		    "layer_type": "postgis",
		    "layer_subtype": "symbol",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "i_fral",
		    "symbol": "icefra_zone",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			}
		    ]
		},
		{ // repeämä
		    "qid": "fracture",
		    "layer_type": "postgis",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "i_fral",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "Fracture"
			    }
			}
		    ]
		},
/*
		{ // railo: Pekko: railoa ei tarvitse humioida
		    "qid": "lead",
		    "layer_type": "postgis",
		    "layer_subtype": "symbol",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "i_lead",
		    "symbol": "lead",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			}
		    ]
		},
*/
		{ // jään liikesuunta
		    "qid": "icedft",
		    "layer_type": "postgis",
		    "layer_subtype": "symbol",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "icedft",
		    "symbol": "icedft",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			}
		    ]
		},
		{ // puristus
		    "qid": "icecom",
		    "layer_type": "postgis",
		    "layer_subtype": "degree_of_pressure",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "icecom",
		    "symbol": "icecom",
		    "geometry_column" : "geom",
		    "labeltext_column" : "iceprs",
		    "attribute_columns" : "iceprs",
		    "time_column" : "publicationdate",
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
 			    "attributes":
			    {
			    },
			    "text_attributes":
			    {
				"font-family": "Arial", // override font from database
				"font-size": "10",
				"dx": "-9",
				"dy": "13",
				"font-style": "normal",
				"font-weight": "normal",
				"text-anchor": "start"
			    }
			}
		    ]
		},
		{ // keskilämpötila
		    "qid": "mean_temperature",
		    "layer_type": "postgis",
		    "layer_subtype": "mean_temperature",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap_static",
		    "table" : "watermeantemp",
		    "geometry_column" : "geom",
		    "attribute_columns" : "o_DD_o_MM_o", // DD and MM are replaced in the query with requested day and month
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "MeanTemperature"
			    },
			    "text_attributes":
			    {
				"font-family": "Arial",
				"font-size": "10",
				"dx": "-5"
			    }
			}
		    ]
		},
/*
		{
		    "qid": "iceegg",
		    "layer_type": "postgis",
		    "layer_subtype": "iceegg",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "seaice",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
		    "cx_offset": "20",
		    "cy_offset": "13",
		    "attribute_columns" : "iceact_label,ca,cb,cc,sa,sb,sc,fa,fb,fc",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "where": "iceact_label='6'",
//			    "where": "type=8 AND iceact IS NOT NULL and gid=100",
			    "attributes":
			    {
				"rx": "30",
				"ry": "35",
				"fill": "white",
				"stroke": "black",
				"stroke-width": "2"
			    },
			    "text_attributes":
			    {
				"font-family": "Arial",
				"font-size": "12",
				"font-style": "normal",
				"font-weight": "normal"
			    }			    
			}
		    ]
		},
*/
		{ // satamat
		    "qid": "harbours",
		    "layer_type": "postgis",
		    "layer_subtype": "named_location",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap_static",
		    "table" : "harbours",
		    "symbol": "harbour",
		    "geometry_column" : "geom",
		    "attribute_columns" : "text1,text2,label_location",
		    "first_name_column" : "text1",		    
		    "second_name_column" : "text2",		    
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"font-family": "Times",
				"font-size": "10",
				"font-style": "normal",
				"font-weight": "normal",
				"text-anchor": "start"
			    }			    
 			}
		    ]
		},
		{ // majakat
		    "qid": "lighthouses",
		    "layer_type": "postgis",
		    "layer_subtype": "named_location",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap_static",
		    "table" : "lighthouses",
		    "symbol": "lighthouse",
		    "geometry_column" : "geom",
		    "attribute_columns" : "namnavaid1,namnavaid2,label_location,angle",
		    "first_name_column" : "namnavaid1",		    
		    "second_name_column" : "namnavaid2",		    
             	    "css": "maps/map.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"font-family": "Arial",
				"font-size": "10",
				"font-style": "normal",
				"font-weight": "normal",
				"text-anchor": "start"
			    }
 			}
		    ]
		},
		{ // jään paksuus
		    "qid": "ice_thickness",
		    "layer_type": "postgis",
		    "layer_subtype": "ice_thickness_label",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "seaiceannotation",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",	
 		    "attribute_columns" : "textstring,fontname,fontsize",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "IceThicknessLegend"
			    },
 			    "text_attributes":
			    {
// here you can override text attributes read from database
//				"font-family": "Times",
//				"font-size": "8"
//				"font-style": "normal",
//				"font-weight": "normal"
			    }
 			}
		    ]
		},
		{ // jään paksuuslaatikon yhdysviiva
		    "qid": "ice_thickness_leader",
		    "layer_type": "postgis",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "annotationleaders",
		    "geometry_column" : "geom",
		    "time_column" : "publicationdate",	
              	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "where": "ref_classname='SeaiceAnnotation' and shape_length > 0",
			    "attributes":
			    {
				"class": "TemperatureIsoline"
			    }
  			}
		    ]
		},
		{ // jäänmurtajat
		    "qid": "ice_breakers",
		    "layer_type": "postgis",
		    "layer_subtype": "ice_breaker_label",
		    "pgname": "popper_icemaps",
		    "schema" : "icemap",
		    "table" : "maptext",
		    "time_column" : "publicationdate",	
		    "geometry_column" : "geom",
		    "attribute_columns" : "textstring,fontname,fontsize",
             	    "css": "ice/icemap.css",
		    "filters" :		    
		    [			
			{
			    "attributes":
			    {
				"class": "IceBreakerLegend"
			    },
			    "text_attributes":
			    {
				"font-family": "Arial", // override font from database
				"font-size": "18",
				"font-style": "normal",
				"font-weight": "normal",
				"text-anchor": "start"
			    }
			}
		    ]
		},
		{ // kartan merkkien selitykset
		    "qid": "legend-1",
		    "tag": "g",
             	    "css": "ice/icemap.css",
		    "layers": "json:ice/icemap_legend1.json",
		    "attributes":
		    {
				"font-family": "Arial",
				"font-size": "10",
				"font-style": "normal",
				"font-weight": "normal",
				"text-anchor": "start"
		    }
		}
	    ]
	}
    ]
}

